---
title: "Walmart Data Exploration"
date: "Sunday, November 08, 2015"
output: html_document
---

To start, the three separate tables that were provided in the Kaggle competition have been merged together into one table. Here's what the head of that table looks like:

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# NOTE: If the following fails with "Error in file...", make sure to set the working director to the 
# directory where this file is found using `setwd()`
source('utility.R')
master <- get.master()
head(master)
```

### Data exploration and visualization

```{r}
require(ggplot2)

get.grouped <- function(groups, filter=NULL){
  if(!is.null(filter)){
    df <- subset(master, master[,filter[1]] == filter[2])
  } else{
    df <- master
  }
  grouped <- ddply(df, groups, summarize, Sales=sum(Weekly_Sales))
  grouped$Sales_Millions <- grouped$Sales / 10e6
  return(grouped)
}

# trending over time
sales.by.week <- get.grouped(c('Date'))
labels <- labs(x='Week', y='Sales (millions)')
ggplot(data=sales.by.week, aes(x=Date, y=Sales_Millions)) + geom_line() + labels

# by store type
sales.by.type <- get.grouped(c('Store_Type','Date'))
ggplot(data=sales.by.type, aes(x=Date, y=Sales_Millions, group=Store_Type, color=Store_Type)) + geom_line() + labels

# by store (by type)
for (store.type in c('A', 'B', 'C')){
  sales.data <- get.grouped(c('Store', 'Date'), c('Store_Type', store.type))
  print(ggplot(data=sales.data, aes(x=Date, y=Sales_Millions, group=Store, color=Store)) + geom_line() + labels + labs(title=paste("Type", store.type, 'Store Sales by Store')) + guides(color=FALSE))
}
```

We can see that Type C stores are less impacted by the Holiday season than the other types of stores. We can also clearly see that mmost stores follow a similar seasonal patterns. Also, we see that some stores have Sales trending upward or downward over the span.

**External Factors**

Relationships between temperature, fuel price, and unemployment.

**Correlations between stores**

**Correlations between departments**